unit UfrmUTQuickReports;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, ComCtrls, QuickRpt, QRCtrls, DB, ExtCtrls, ADODB, DateUtils;

type
  TfrmUTQuickReports = class(TForm)
    PageControl1: TPageControl;
    tabUnitTransactionNote: TTabSheet;
    spRptUnitTransactionNote: TADOStoredProc;
    tblCompany: TADOTable;
    tblCompanyID: TLargeintField;
    tblCompanyVATRegistrationNo: TStringField;
    tblCompanyName: TStringField;
    tblCompanyPhysicalAddress: TStringField;
    tblCompanyPhysicalAddress2: TStringField;
    tblCompanyPhysicalAddress3: TStringField;
    tblCompanyPhysicalCity: TIntegerField;
    tblCompanyPhysicalCountry: TIntegerField;
    tblCompanyPostalAddress: TStringField;
    tblCompanyPostalAddress2: TStringField;
    tblCompanyPostalAddress3: TStringField;
    tblCompanyPostalCity: TIntegerField;
    tblCompanyPostalCountry: TIntegerField;
    tblCompanyPhoneNo: TStringField;
    tblCompanyPhoneNo2: TStringField;
    tblCompanyPhoneNo3: TStringField;
    tblCompanyFaxNo: TStringField;
    tblCompanyEmailAddress: TStringField;
    tblCompanyReportAddress: TStringField;
    tblCompanyLogo: TBlobField;
    spRptUTTransactions: TADOStoredProc;
    spRptUTTransactionsID: TLargeintField;
    spRptUTTransactionsAccountName: TStringField;
    spRptUTTransactionsClientNo: TStringField;
    spRptUTTransactionsAmount: TFloatField;
    spRptUTTransactionsValueDate: TDateTimeField;
    spRptUTTransactionsUserName: TWideStringField;
    spRptUTTransactionsStartDate: TDateTimeField;
    spRptUTTransactionsEndDate: TDateTimeField;
    spRptUTTransactionsTransactionTypeName: TStringField;
    TabSheet1: TTabSheet;
    QRUTTransactionList: TQuickRep;
    QRBand241: TQRBand;
    QRDBText532: TQRDBText;
    QRDBText535: TQRDBText;
    QRDBText538: TQRDBText;
    QRDBText540: TQRDBText;
    QRDBText546: TQRDBText;
    QRDBText539: TQRDBText;
    QRBand242: TQRBand;
    QRLabel563: TQRLabel;
    QRDBText543: TQRDBText;
    QRLabel565: TQRLabel;
    QRLabel567: TQRLabel;
    QRDBImage47: TQRDBImage;
    QRDBText544: TQRDBText;
    QRDBText545: TQRDBText;
    QRLabel573: TQRLabel;
    QRDBText541: TQRDBText;
    QRBand243: TQRBand;
    QRLabel569: TQRLabel;
    QRLabel570: TQRLabel;
    QRLabel571: TQRLabel;
    QRLabel572: TQRLabel;
    QRLabel568: TQRLabel;
    QRLabel577: TQRLabel;
    QRBand244: TQRBand;
    QRExpr205: TQRExpr;
    spRptUnitDealNote: TADOStoredProc;
    spRptUnitDealNoteID: TLargeintField;
    spRptUnitDealNoteAccountID: TLargeintField;
    spRptUnitDealNoteAccountNo: TStringField;
    spRptUnitDealNoteAccountName: TStringField;
    spRptUnitDealNoteValueDate: TDateTimeField;
    spRptUnitDealNoteUnitTrustID: TIntegerField;
    spRptUnitDealNoteUnitTrustName: TStringField;
    spRptUnitDealNoteAmount: TFloatField;
    spRptUnitDealNoteUnitPrice: TFloatField;
    spRptUnitDealNoteQuantity: TFloatField;
    spRptUnitDealNoteUnitDealType: TIntegerField;
    spRptUnitDealNoteUnitDealTypeName: TStringField;
    spRptUnitDealNoteCreationDate: TDateTimeField;
    TabSheet2: TTabSheet;
    spRptUnitDeals: TADOStoredProc;
    TabSheet3: TTabSheet;
    spRptFeeComputation: TADOStoredProc;
    spRptFeeComputationID: TLargeintField;
    spRptFeeComputationUnitTrustFeeType: TIntegerField;
    spRptFeeComputationUnitTrustFeeName: TStringField;
    spRptFeeComputationUnitTrustID: TLargeintField;
    spRptFeeComputationUnitTrustName: TStringField;
    spRptFeeComputationDate: TDateTimeField;
    spRptFeeComputationPercentage: TFloatField;
    spRptFeeComputationNAV: TFloatField;
    spRptFeeComputationFee: TFloatField;
    spRptFeeComputationFeeCumulative: TFloatField;
    TabSheet4: TTabSheet;
    QRUnitFeeComputation: TQuickRep;
    QRBand118: TQRBand;
    QRLabel269: TQRLabel;
    QRDBText236: TQRDBText;
    QRLabel275: TQRLabel;
    QRDBText235: TQRDBText;
    QRLabel285: TQRLabel;
    QRDBImage24: TQRDBImage;
    QRDBText273: TQRDBText;
    QRBand119: TQRBand;
    QRLabel277: TQRLabel;
    QRLabel278: TQRLabel;
    QRLabel279: TQRLabel;
    QRLabel280: TQRLabel;
    QRLabel286: TQRLabel;
    QRBand120: TQRBand;
    QRDBText243: TQRDBText;
    QRDBText245: TQRDBText;
    QRDBText246: TQRDBText;
    QRDBText248: TQRDBText;
    QRDBText244: TQRDBText;
    QRBand121: TQRBand;
    QRSysData36: TQRSysData;
    QRLabel282: TQRLabel;
    lblUnitFeePge: TQRLabel;
    QRSysData37: TQRSysData;
    QRBand122: TQRBand;
    TabSheet5: TTabSheet;
    spRptUnitTrustHoldingsSummary: TADOStoredProc;
    TabSheet6: TTabSheet;
    QRUTHoldingsSummary: TQuickRep;
    QRBand135: TQRBand;
    QRLabel6: TQRLabel;
    QRDBText289: TQRDBText;
    QRDBImage27: TQRDBImage;
    QRDBText291: TQRDBText;
    QRBand136: TQRBand;
    QRLabel308: TQRLabel;
    QRLabel309: TQRLabel;
    QRLabel310: TQRLabel;
    QRLabel311: TQRLabel;
    QRLabel312: TQRLabel;
    QRLabel313: TQRLabel;
    QRLabel305: TQRLabel;
    QRBand137: TQRBand;
    QRDBText293: TQRDBText;
    QRDBText294: TQRDBText;
    QRDBText295: TQRDBText;
    QRDBText296: TQRDBText;
    QRDBText297: TQRDBText;
    QRDBText298: TQRDBText;
    QRDBText290: TQRDBText;
    QRBand138: TQRBand;
    QRSysData42: TQRSysData;
    QRLabel314: TQRLabel;
    lblUTHoldingsSPge: TQRLabel;
    QRSysData43: TQRSysData;
    QRBand139: TQRBand;
    QRExpr95: TQRExpr;
    QRExpr96: TQRExpr;
    QRExpr97: TQRExpr;
    QRExpr98: TQRExpr;
    tabCheque: TTabSheet;
    QRCheque: TQuickRep;
    spChequePayment: TADOStoredProc;
    QRBand1: TQRBand;
    QRBand2: TQRBand;
    QRBand3: TQRBand;
    QRDBText1: TQRDBText;
    QRDBText2: TQRDBText;
    QRDBText3: TQRDBText;
    QRDBText4: TQRDBText;
    QRDBText5: TQRDBText;
    QRDBText6: TQRDBText;
    QRDBText7: TQRDBText;
    QRDBText8: TQRDBText;
    QRDBText9: TQRDBText;
    QRDBText10: TQRDBText;
    QRDBText11: TQRDBText;
    QRDBText12: TQRDBText;
    QRDBText13: TQRDBText;
    QRDBText14: TQRDBText;
    QRDBText15: TQRDBText;
    QRLabel1: TQRLabel;
    QRLabel2: TQRLabel;
    QRLabel3: TQRLabel;
    QRLabel4: TQRLabel;
    QRDBText16: TQRDBText;
    spChequePaymentCounterpartyName: TStringField;
    spChequePaymentClientNo: TStringField;
    spChequePaymentcpAccountID: TLargeintField;
    spChequePaymentTrxnValueDate: TDateTimeField;
    spChequePaymentTrxnDebitAmount: TFloatField;
    spChequePaymenttrxnCreditAmount: TFloatField;
    spChequePaymentTrxnTypeName: TStringField;
    spChequePaymentChequeValueDate: TDateTimeField;
    spChequePaymentChequeAmount: TFloatField;
    spChequePaymentChequeName: TStringField;
    spChequePaymentchqMillions: TStringField;
    spChequePaymentchqHOT: TStringField;
    spChequePaymentchqTOT: TStringField;
    spChequePaymentchqThousands: TStringField;
    spChequePaymentchqHundreds: TStringField;
    spChequePaymentchqTens: TStringField;
    spChequePaymentchqUnits: TStringField;
    spChequePaymentchqAmountWords: TStringField;
    spRptUnitTransactionNoteID: TAutoIncField;
    spRptUnitTransactionNoteAccountID: TIntegerField;
    spRptUnitTransactionNoteAccountNo: TStringField;
    spRptUnitTransactionNoteAccountName: TStringField;
    spRptUnitTransactionNoteValueDate: TDateTimeField;
    spRptUnitTransactionNoteUnitTrustID: TIntegerField;
    spRptUnitTransactionNoteUnitTrustName: TStringField;
    spRptUnitTransactionNoteDealType: TIntegerField;
    spRptUnitTransactionNoteTransactionTypeName: TStringField;
    spRptUnitTransactionNoteCreationDate: TDateTimeField;
    spRptUnitTransactionNoteTranUserName: TStringField;
    spRptUnitTransactionNoteAmountType: TStringField;
    spRptUnitTransactionNoteAmount: TFloatField;
    spRptUnitTransactionNoteCurrencySubTotal: TFloatField;
    spRptUnitTransactionNoteCurrencyConversionRate: TFloatField;
    spRptUnitTransactionNoteCurrCode: TStringField;
    TabSheet7: TTabSheet;
    QRUTComparison: TQuickRep;
    QRBand4: TQRBand;
    QRDBText21: TQRDBText;
    QRDBText22: TQRDBText;
    QRDBText23: TQRDBText;
    QRDBText24: TQRDBText;
    QRDBText25: TQRDBText;
    QRDBText26: TQRDBText;
    QRBand5: TQRBand;
    QRLabel9: TQRLabel;
    QRDBText27: TQRDBText;
    QRLabel10: TQRLabel;
    QRLabel11: TQRLabel;
    QRDBImage1: TQRDBImage;
    QRDBText28: TQRDBText;
    QRDBText29: TQRDBText;
    QRBand6: TQRBand;
    QRLabel15: TQRLabel;
    QRLabel16: TQRLabel;
    QRLabel17: TQRLabel;
    QRLabel18: TQRLabel;
    QRExpr2: TQRExpr;
    spRptUnitTrustComparison: TADOStoredProc;
    spRptUnitTrustComparisonID: TLargeintField;
    spRptUnitTrustComparisonName: TStringField;
    spRptUnitTrustComparisonShortName: TStringField;
    spRptUnitTrustComparisonStartDate: TDateTimeField;
    spRptUnitTrustComparisonEndDate: TDateTimeField;
    spRptUnitTrustComparisonStartPrice: TFloatField;
    spRptUnitTrustComparisonEndPrice: TFloatField;
    spRptUnitTrustComparisonAvgPrice: TFloatField;
    spRptUnitTrustComparisonDiff: TFloatField;
    spRptUnitTrustComparisonPercentageDiff: TFloatField;
    QRExpr3: TQRExpr;
    spRptUnitTransactionNoteClientNo: TStringField;
    TabSheet8: TTabSheet;
    QRCreations: TQuickRep;
    QRBand7: TQRBand;
    QRDBImage2: TQRDBImage;
    QRDBText31: TQRDBText;
    QRBand8: TQRBand;
    QRBand9: TQRBand;
    QRSysData1: TQRSysData;
    QRBand10: TQRBand;
    QRBand11: TQRBand;
    QRDBText32: TQRDBText;
    QRLabel13: TQRLabel;
    QRLabel14: TQRLabel;
    QRLabel19: TQRLabel;
    QRDBText33: TQRDBText;
    QRDBText34: TQRDBText;
    QRLabel22: TQRLabel;
    QRDBText38: TQRDBText;
    spRptUTCreations: TADOStoredProc;
    QRLabel20: TQRLabel;
    QRDBText36: TQRDBText;
    QRDBText40: TQRDBText;
    QRLabel26: TQRLabel;
    spRptUTCreationsUnitTrustID: TIntegerField;
    spRptUTCreationsValueDate: TDateTimeField;
    spRptUTCreationsStartUnits: TFloatField;
    spRptUTCreationsAmountDifference: TFloatField;
    spRptUTCreationsUnitsDifference: TFloatField;
    spRptUTCreationsEndUnits: TFloatField;
    spRptUTCreationsUnitTrust: TStringField;
    QRLabel21: TQRLabel;
    QRLabel23: TQRLabel;
    QRDBText35: TQRDBText;
    QRLabel24: TQRLabel;
    QRLabel25: TQRLabel;
    QRShape30: TQRShape;
    QRShape1: TQRShape;
    QRLabel390: TQRLabel;
    QRShape2: TQRShape;
    QRLabel393: TQRLabel;
    QRShape45: TQRShape;
    QRSysData2: TQRSysData;
    spRptUTCreationsUnitPrice: TFloatField;
    TabSheet9: TTabSheet;
    QRCapitalGains: TQuickRep;
    QRBand12: TQRBand;
    QRLabel27: TQRLabel;
    QRDBImage3: TQRDBImage;
    QRDBText39: TQRDBText;
    QRBand13: TQRBand;
    QRLabel28: TQRLabel;
    QRLabel29: TQRLabel;
    QRLabel30: TQRLabel;
    QRLabel31: TQRLabel;
    QRLabel32: TQRLabel;
    QRLabel33: TQRLabel;
    QRLabel34: TQRLabel;
    QRBand14: TQRBand;
    QRDBText41: TQRDBText;
    QRDBText42: TQRDBText;
    QRDBText43: TQRDBText;
    QRDBText44: TQRDBText;
    QRDBText45: TQRDBText;
    QRDBText46: TQRDBText;
    QRDBText47: TQRDBText;
    QRBand15: TQRBand;
    QRSysData3: TQRSysData;
    QRLabel35: TQRLabel;
    QRLabel36: TQRLabel;
    QRSysData4: TQRSysData;
    QRBand16: TQRBand;
    QRExpr6: TQRExpr;
    QRLabel37: TQRLabel;
    QRLabel38: TQRLabel;
    QRLabel39: TQRLabel;
    QRLabel40: TQRLabel;
    QRDBText48: TQRDBText;
    spRptUnitCapitalGains: TADOStoredProc;
    spRptUnitCapitalGainsID: TLargeintField;
    spRptUnitCapitalGainsUnitTrustName: TStringField;
    spRptUnitCapitalGainsAccountID: TLargeintField;
    spRptUnitCapitalGainsAccountNo: TStringField;
    spRptUnitCapitalGainsClientNo: TStringField;
    spRptUnitCapitalGainsLongName: TStringField;
    spRptUnitCapitalGainsValueDate: TDateTimeField;
    spRptUnitCapitalGainsQuantity: TFloatField;
    spRptUnitCapitalGainsAmount: TFloatField;
    spRptUnitCapitalGainsSellBookValue: TFloatField;
    spRptUnitCapitalGainsProfit: TFloatField;
    QRDBText49: TQRDBText;
    spRptUnitCapitalGainsAccount: TStringField;
    spRptUnitCapitalGainsUnitTrust: TStringField;
    spRptUnitCapitalGainsStartDate: TDateTimeField;
    spRptUnitCapitalGainsEndDate: TDateTimeField;
    QRDBText37: TQRDBText;
    QRDBText50: TQRDBText;
    QRExpr1: TQRExpr;
    QRExpr4: TQRExpr;
    TabSheet10: TTabSheet;
    QRClientSpecialInstructions: TQuickRep;
    QRBand17: TQRBand;
    QRDBText52: TQRDBText;
    QRDBText53: TQRDBText;
    QRDBText55: TQRDBText;
    QRBand18: TQRBand;
    QRLabel41: TQRLabel;
    QRDBText57: TQRDBText;
    QRLabel42: TQRLabel;
    QRDBImage4: TQRDBImage;
    QRDBText58: TQRDBText;
    QRLabel44: TQRLabel;
    QRDBText60: TQRDBText;
    QRBand19: TQRBand;
    QRLabel45: TQRLabel;
    QRLabel46: TQRLabel;
    QRLabel50: TQRLabel;
    spRptClientSpecialInstructions: TADOStoredProc;
    spRptClientSpecialInstructionsID: TLargeintField;
    spRptClientSpecialInstructionsClientNo: TStringField;
    spRptClientSpecialInstructionsLongName: TStringField;
    spRptClientSpecialInstructionsSpecialInstructions: TStringField;
    spRptClientSpecialInstructionsCustodialGroup: TIntegerField;
    spRptClientSpecialInstructionsCounterpartyType: TIntegerField;
    spRptClientSpecialInstructionsOrderField: TStringField;
    spRptClientSpecialInstructionsCustodialGroupName: TStringField;
    spRptClientSpecialInstructionsCounterpartyTypeName: TStringField;
    spRptClientSpecialInstructionsOrderBy: TStringField;
    PageFooterBand1: TQRBand;
    QRSysData5: TQRSysData;
    QRSysData6: TQRSysData;
    QRLabel43: TQRLabel;
    QRLabel47: TQRLabel;
    TabSheet11: TTabSheet;
    QRUTClientList: TQuickRep;
    QRBand20: TQRBand;
    QRLabel48: TQRLabel;
    QRDBImage5: TQRDBImage;
    QRDBText54: TQRDBText;
    QRBand21: TQRBand;
    QRLabel49: TQRLabel;
    QRLabel51: TQRLabel;
    QRLabel52: TQRLabel;
    QRLabel53: TQRLabel;
    QRLabel54: TQRLabel;
    QRLabel55: TQRLabel;
    QRLabel56: TQRLabel;
    QRBand22: TQRBand;
    QRDBText56: TQRDBText;
    QRDBText59: TQRDBText;
    QRDBText61: TQRDBText;
    QRDBText62: TQRDBText;
    QRDBText63: TQRDBText;
    QRBand23: TQRBand;
    QRSysData7: TQRSysData;
    QRLabel57: TQRLabel;
    QRLabel58: TQRLabel;
    QRSysData8: TQRSysData;
    QRBand24: TQRBand;
    QRExpr5: TQRExpr;
    QRExpr8: TQRExpr;
    QRExpr9: TQRExpr;
    QRGroup35: TQRGroup;
    QRLabel59: TQRLabel;
    QRDBText66: TQRDBText;
    QRBand271: TQRBand;
    QRExpr217: TQRExpr;
    QRExpr245: TQRExpr;
    QRExpr246: TQRExpr;
    QRLabel60: TQRLabel;
    spRptUTClientList: TADOStoredProc;
    QRDBText64: TQRDBText;
    QRDBText65: TQRDBText;
    QRDBText67: TQRDBText;
    QRLabel61: TQRLabel;
    QRDBText68: TQRDBText;
    QRLabel62: TQRLabel;
    QRDBText69: TQRDBText;
    QRLabel63: TQRLabel;
    QRDBText70: TQRDBText;
    QRLabel64: TQRLabel;
    QRDBText71: TQRDBText;
    QRLabel65: TQRLabel;
    QRDBText72: TQRDBText;
    TabSheet12: TTabSheet;
    QRExceptions: TQuickRep;
    QRBand25: TQRBand;
    QRLabel66: TQRLabel;
    QRDBImage6: TQRDBImage;
    QRDBText51: TQRDBText;
    QRLabel68: TQRLabel;
    QRDBText74: TQRDBText;
    QRLabel69: TQRLabel;
    QRDBText75: TQRDBText;
    QRLabel70: TQRLabel;
    QRDBText76: TQRDBText;
    QRLabel71: TQRLabel;
    QRDBText77: TQRDBText;
    QRBand26: TQRBand;
    QRLabel72: TQRLabel;
    QRLabel73: TQRLabel;
    QRLabel75: TQRLabel;
    QRLabel77: TQRLabel;
    QRLabel78: TQRLabel;
    QRLabel79: TQRLabel;
    QRBand27: TQRBand;
    QRDBText78: TQRDBText;
    QRDBText79: TQRDBText;
    QRDBText80: TQRDBText;
    QRDBText81: TQRDBText;
    QRDBText82: TQRDBText;
    QRDBText84: TQRDBText;
    QRBand28: TQRBand;
    QRSysData9: TQRSysData;
    QRLabel80: TQRLabel;
    QRLabel81: TQRLabel;
    QRSysData10: TQRSysData;
    QRBand29: TQRBand;
    QRExpr7: TQRExpr;
    QRExpr10: TQRExpr;
    QRExpr11: TQRExpr;
    QRGroup1: TQRGroup;
    QRLabel82: TQRLabel;
    QRDBText86: TQRDBText;
    QRBand30: TQRBand;
    QRExpr12: TQRExpr;
    QRExpr13: TQRExpr;
    QRExpr14: TQRExpr;
    spRptUTExceptions: TADOStoredProc;
    spRptUTExceptionsID: TLargeintField;
    spRptUTExceptionsType: TStringField;
    spRptUTExceptionsClientNo: TStringField;
    spRptUTExceptionsLongName: TStringField;
    spRptUTExceptionsActualBalance: TFloatField;
    spRptUTExceptionsUnitTrustName: TStringField;
    spRptUTExceptionsUnitsHeld: TFloatField;
    spRptUTExceptionsBookValue: TFloatField;
    spRptUTExceptionsMarketValue: TFloatField;
    spRptUTExceptionsUpfrontFee: TBooleanField;
    spRptUTExceptionsCustodialGroup: TIntegerField;
    spRptUTExceptionsCounterpartyType: TIntegerField;
    spRptUTExceptionsOrderField: TStringField;
    spRptUTExceptionsCustodialGroupName: TStringField;
    spRptUTExceptionsCounterpartyTypeName: TStringField;
    spRptUTExceptionsOrderBy: TStringField;
    spRptUTExceptionsValueDate: TDateTimeField;
    QRGroup2: TQRGroup;
    QRLabel67: TQRLabel;
    QRDBText73: TQRDBText;
    QRBand31: TQRBand;
    QRExpr15: TQRExpr;
    QRExpr16: TQRExpr;
    QRExpr17: TQRExpr;
    QRExpr18: TQRExpr;
    QRExpr19: TQRExpr;
    QRExpr20: TQRExpr;
    QRLabel74: TQRLabel;
    QRDBText83: TQRDBText;
    spRptUnitTrustHoldingsSummaryID: TLargeintField;
    spRptUnitTrustHoldingsSummaryName: TStringField;
    spRptUnitTrustHoldingsSummaryValueDate: TDateTimeField;
    spRptUnitTrustHoldingsSummaryQuantity: TFloatField;
    spRptUnitTrustHoldingsSummaryBookValue: TFloatField;
    spRptUnitTrustHoldingsSummaryBidPrice: TFloatField;
    spRptUnitTrustHoldingsSummaryMarketValue: TFloatField;
    spRptUnitTrustHoldingsSummaryProfit: TFloatField;
    spRptUnitTrustHoldingsSummaryPercentageProfit: TFloatField;
    TabSheet13: TTabSheet;
    spRptUnitStatement: TADOStoredProc;
    QRUTStatement: TQuickRep;
    S: TQRBand;
    QRDBText85: TQRDBText;
    QRLabel76: TQRLabel;
    QRDBText87: TQRDBText;
    QRLabel83: TQRLabel;
    QRDBText88: TQRDBText;
    QRLabel84: TQRLabel;
    QRLabel85: TQRLabel;
    QRDBText89: TQRDBText;
    QRDBText90: TQRDBText;
    QRDBImage7: TQRDBImage;
    QRDBText251: TQRDBText;
    QRDBText91: TQRDBText;
    QRDBText498: TQRDBText;
    QRDBText501: TQRDBText;
    QRDBText502: TQRDBText;
    QRDBText503: TQRDBText;
    QRDBText554: TQRDBText;
    QRLabel585: TQRLabel;
    QRBand32: TQRBand;
    QRDBText96: TQRDBText;
    QRBand33: TQRBand;
    QRDBText567: TQRDBText;
    QRBand34: TQRBand;
    lblStatPageCount: TQRLabel;
    QRLabel99: TQRLabel;
    QRSysData11: TQRSysData;
    QRSysData72: TQRSysData;
    QRBand35: TQRBand;
    QRGroup3: TQRGroup;
    QRLabel88: TQRLabel;
    QRExpr30: TQRExpr;
    QRExpr29: TQRExpr;
    QRExpr28: TQRExpr;
    QRExpr27: TQRExpr;
    QRExpr26: TQRExpr;
    QRExpr25: TQRExpr;
    QRExpr24: TQRExpr;
    QRExpr23: TQRExpr;
    QRExpr22: TQRExpr;
    QRExpr21: TQRExpr;
    QRExpr31: TQRExpr;
    QRExpr32: TQRExpr;
    QRExpr33: TQRExpr;
    QRExpr34: TQRExpr;
    QRExpr35: TQRExpr;
    QRExpr36: TQRExpr;
    QRExpr37: TQRExpr;
    QRExpr38: TQRExpr;
    QRExpr39: TQRExpr;
    QRExpr40: TQRExpr;
    QRExpr41: TQRExpr;
    QRExpr42: TQRExpr;
    QRBand36: TQRBand;
    QRExpr43: TQRExpr;
    QRExpr44: TQRExpr;
    QRExpr45: TQRExpr;
    QRExpr46: TQRExpr;
    QRExpr47: TQRExpr;
    QRExpr48: TQRExpr;
    spStatementPrintCharge: TADOStoredProc;
    spRptUnitCounterparyHoldings: TADOStoredProc;
    QRUnitCounterpartyHoldings: TQuickRep;
    QRBand129: TQRBand;
    QRLabel294: TQRLabel;
    QRDBText279: TQRDBText;
    QRDBImage26: TQRDBImage;
    QRDBText281: TQRDBText;
    QRLabel679: TQRLabel;
    QRDBText611: TQRDBText;
    QRBand131: TQRBand;
    QRLabel297: TQRLabel;
    QRLabel298: TQRLabel;
    QRLabel299: TQRLabel;
    QRLabel300: TQRLabel;
    QRLabel301: TQRLabel;
    QRLabel302: TQRLabel;
    QRLabel303: TQRLabel;
    QRLabel210: TQRLabel;
    QRBand132: TQRBand;
    QRDBText282: TQRDBText;
    QRDBText283: TQRDBText;
    QRDBText284: TQRDBText;
    QRDBText285: TQRDBText;
    QRDBText286: TQRDBText;
    QRDBText287: TQRDBText;
    QRDBText288: TQRDBText;
    QRDBText189: TQRDBText;
    QRBand133: TQRBand;
    QRSysData40: TQRSysData;
    QRLabel304: TQRLabel;
    lblUCHoldingsPge: TQRLabel;
    QRSysData41: TQRSysData;
    QRBand134: TQRBand;
    QRExpr91: TQRExpr;
    QRExpr92: TQRExpr;
    QRExpr94: TQRExpr;
    QRExpr108: TQRExpr;
    QRBand272: TQRBand;
    QRExpr247: TQRExpr;
    QRExpr248: TQRExpr;
    QRExpr249: TQRExpr;
    QRExpr250: TQRExpr;
    QRGroup36: TQRGroup;
    QRDBText280: TQRDBText;
    QRLabel296: TQRLabel;
    spRptUnitCounterparyHoldingsID: TLargeintField;
    spRptUnitCounterparyHoldingsAccountID: TLargeintField;
    spRptUnitCounterparyHoldingsValueDate: TDateTimeField;
    spRptUnitCounterparyHoldingsLongName: TStringField;
    spRptUnitCounterparyHoldingsClientNo: TStringField;
    spRptUnitCounterparyHoldingsUnitTrustName: TStringField;
    spRptUnitCounterparyHoldingsUnitsHeld: TFloatField;
    spRptUnitCounterparyHoldingsBookValue: TFloatField;
    spRptUnitCounterparyHoldingsBidPrice: TFloatField;
    spRptUnitCounterparyHoldingsUnitsValue: TFloatField;
    spRptUnitCounterparyHoldingsProfit: TFloatField;
    spRptUnitCounterparyHoldingsPercentageProfit: TFloatField;
    spRptUnitCounterparyHoldingsBranch: TStringField;
    QRShape3: TQRShape;
    QRLabel86: TQRLabel;
    QRShape5: TQRShape;
    QRLabel89: TQRLabel;
    QRShape6: TQRShape;
    QRLabel90: TQRLabel;
    QRShape7: TQRShape;
    QRLabel91: TQRLabel;
    SummaryBand1: TQRBand;
    QRShape8: TQRShape;
    QRLabel92: TQRLabel;
    QRShape9: TQRShape;
    QRLabel93: TQRLabel;
    SummaryBand2: TQRBand;
    QRShape10: TQRShape;
    QRLabel94: TQRLabel;
    QRShape11: TQRShape;
    QRLabel95: TQRLabel;
    QRShape12: TQRShape;
    QRLabel96: TQRLabel;
    spRptUnitTrustCounterparyHoldings: TADOStoredProc;
    QRUnitHoldings: TQuickRep;
    QRBand107: TQRBand;
    QRLabel252: TQRLabel;
    QRDBText224: TQRDBText;
    QRDBImage22: TQRDBImage;
    QRDBText271: TQRDBText;
    QRLabel680: TQRLabel;
    QRDBText612: TQRDBText;
    QRBand108: TQRBand;
    QRLabel256: TQRLabel;
    QRLabel257: TQRLabel;
    QRLabel258: TQRLabel;
    QRLabel260: TQRLabel;
    QRLabel287: TQRLabel;
    QRLabel289: TQRLabel;
    QRLabel290: TQRLabel;
    QRBand109: TQRBand;
    QRDBText228: TQRDBText;
    QRDBText229: TQRDBText;
    QRDBText230: TQRDBText;
    QRDBText232: TQRDBText;
    QRDBText275: TQRDBText;
    QRDBText276: TQRDBText;
    QRDBText277: TQRDBText;
    QRBand110: TQRBand;
    QRSysData32: TQRSysData;
    QRLabel262: TQRLabel;
    lblUTHoldingsPge: TQRLabel;
    QRSysData33: TQRSysData;
    QRBand111: TQRBand;
    QRExpr82: TQRExpr;
    QRExpr84: TQRExpr;
    QRExpr93: TQRExpr;
    QRExpr109: TQRExpr;
    QRShape24: TQRShape;
    QRLabel229: TQRLabel;
    QRGroup4: TQRGroup;
    QRLabel253: TQRLabel;
    QRDBText225: TQRDBText;
    QRLabel202: TQRLabel;
    QRDBText185: TQRDBText;
    QRBand37: TQRBand;
    QRExpr49: TQRExpr;
    QRExpr243: TQRExpr;
    QRExpr50: TQRExpr;
    QRExpr51: TQRExpr;
    TabSheet14: TTabSheet;
    QRWelcomeLetterMAM: TQuickRep;
    QRBand38: TQRBand;
    QRDBText18: TQRDBText;
    QRDBImage8: TQRDBImage;
    QRDBText92: TQRDBText;
    QRDBText93: TQRDBText;
    QRDBText94: TQRDBText;
    QRDBText95: TQRDBText;
    QRDBText97: TQRDBText;
    QRDBText98: TQRDBText;
    QRBand39: TQRBand;
    QRBand41: TQRBand;
    QRBand42: TQRBand;
    QRBand239: TQRBand;
    QRDBText17: TQRDBText;
    spRptUTWelcomeLetter: TADOStoredProc;
    spRptUTWelcomeLetterID: TLargeintField;
    spRptUTWelcomeLetterClientID: TLargeintField;
    spRptUTWelcomeLetterAccountID: TLargeintField;
    spRptUTWelcomeLetterLongName: TStringField;
    spRptUTWelcomeLetterClientNo: TStringField;
    spRptUTWelcomeLetterPostalAddress: TStringField;
    spRptUTWelcomeLetterPostalAddress2: TStringField;
    spRptUTWelcomeLetterPostalAddress3: TStringField;
    spRptUTWelcomeLetterCity: TStringField;
    spRptUTWelcomeLetterCountry: TStringField;
    spRptUTWelcomeLetterValueDate: TDateTimeField;
    spRptUTWelcomeLetterDetails: TStringField;
    QRUTTransactionNote: TQuickRep;
    QRBand236: TQRBand;
    QRDBImage46: TQRDBImage;
    QRDBText531: TQRDBText;
    QRExpr204: TQRExpr;
    QRBand238: TQRBand;
    QRSysData68: TQRSysData;
    QRBand240: TQRBand;
    QRDBText534: TQRDBText;
    QRLabel564: TQRLabel;
    QRLabel535: TQRLabel;
    QRLabel562: TQRLabel;
    QRDBText533: TQRDBText;
    QRDBText537: TQRDBText;
    QRDBText536: TQRDBText;
    QRLabel574: TQRLabel;
    QRDBText542: TQRDBText;
    QRDBText547: TQRDBText;
    QRLabel575: TQRLabel;
    QRLabel576: TQRLabel;
    QRDBText548: TQRDBText;
    QRDBText30: TQRDBText;
    QRDBText100: TQRDBText;
    QRLabel5: TQRLabel;
    QRDBText101: TQRDBText;
    QRLabel8: TQRLabel;
    QRLabel12: TQRLabel;
    QRDBText102: TQRDBText;
    QRDBText103: TQRDBText;
    QRLabel97: TQRLabel;
    QRExpr52: TQRExpr;
    spRptUTWelcomeLetterUnitTrust: TStringField;
    spRptUTWelcomeLetterAmount: TFloatField;
    spRptUTWelcomeLetterCurrCode: TStringField;
    spRptUTWelcomeLetterAgentName: TStringField;
    spRptUTWelcomeLetterTeamLeaderName: TStringField;
    QRExpr54: TQRExpr;
    QRExpr55: TQRExpr;
    QRExpr56: TQRExpr;
    QRExpr57: TQRExpr;
    QRExpr58: TQRExpr;
    QRExpr59: TQRExpr;
    QRExpr60: TQRExpr;
    QRExpr61: TQRExpr;
    QRExpr62: TQRExpr;
    QRExpr63: TQRExpr;
    QRExpr64: TQRExpr;
    QRExpr53: TQRExpr;
    QRExpr65: TQRExpr;
    TabSheet15: TTabSheet;
    QRWelcomeLetter: TQuickRep;
    QRBand40: TQRBand;
    QRDBText19: TQRDBText;
    QRDBImage9: TQRDBImage;
    QRDBText20: TQRDBText;
    QRDBText99: TQRDBText;
    QRDBText104: TQRDBText;
    QRDBText105: TQRDBText;
    QRDBText106: TQRDBText;
    QRDBText107: TQRDBText;
    QRDBText108: TQRDBText;
    QRExpr66: TQRExpr;
    QRExpr67: TQRExpr;
    QRBand43: TQRBand;
    QRExpr68: TQRExpr;
    QRExpr69: TQRExpr;
    QRExpr70: TQRExpr;
    QRExpr76: TQRExpr;
    QRExpr77: TQRExpr;
    QRExpr78: TQRExpr;
    QRExpr79: TQRExpr;
    QRBand44: TQRBand;
    QRBand45: TQRBand;
    QRBand46: TQRBand;
    spRptUnitDealsID: TLargeintField;
    spRptUnitDealsAccountID: TLargeintField;
    spRptUnitDealsAccountNo: TStringField;
    spRptUnitDealsClientNo: TStringField;
    spRptUnitDealsLongName: TStringField;
    spRptUnitDealsUnitTrustID: TIntegerField;
    spRptUnitDealsValueDate: TDateTimeField;
    spRptUnitDealsUnitDealType: TIntegerField;
    spRptUnitDealsCapturersUserName: TStringField;
    spRptUnitDealsCapturersBranch: TStringField;
    spRptUnitDealsConfirmersUserName: TStringField;
    spRptUnitDealsConfirmersBranch: TStringField;
    spRptUnitDealsRejectersUserName: TStringField;
    spRptUnitDealsRejectersBranch: TStringField;
    spRptUnitDealsUnitDealTypeName: TStringField;
    spRptUnitDealsQuantity: TBCDField;
    spRptUnitDealsUnitPrice: TBCDField;
    spRptUnitDealsSubTotal: TBCDField;
    spRptUnitDealsCreationDate: TDateTimeField;
    spRptUnitDealsUnitTrustName: TStringField;
    spRptUnitDealsStartDate: TDateTimeField;
    spRptUnitDealsEndDate: TDateTimeField;
    spRptUnitDealsStatus: TStringField;
    spRptUnitTrustCounterparyHoldingsID: TIntegerField;
    spRptUnitTrustCounterparyHoldingsAccountID: TIntegerField;
    spRptUnitTrustCounterparyHoldingsValueDate: TDateTimeField;
    spRptUnitTrustCounterparyHoldingsLongName: TStringField;
    spRptUnitTrustCounterparyHoldingsClientNo: TStringField;
    spRptUnitTrustCounterparyHoldingsUnitTrustName: TStringField;
    spRptUnitTrustCounterparyHoldingsUnitsHeld: TBCDField;
    spRptUnitTrustCounterparyHoldingsBookValue: TBCDField;
    spRptUnitTrustCounterparyHoldingsBidPrice: TBCDField;
    spRptUnitTrustCounterparyHoldingsUnitsValue: TBCDField;
    spRptUnitTrustCounterparyHoldingsProfit: TBCDField;
    spRptUnitTrustCounterparyHoldingsPercentageProfit: TBCDField;
    spRptUnitTrustCounterparyHoldingsBranch: TStringField;
    spRptUTClientListID: TLargeintField;
    spRptUTClientListClientNo: TStringField;
    spRptUTClientListLongName: TStringField;
    spRptUTClientListPhoneNo: TStringField;
    spRptUTClientListBranch: TStringField;
    spRptUTClientListUnitTrustName: TStringField;
    spRptUTClientListUnitsHeld: TFloatField;
    spRptUTClientListBookValue: TFloatField;
    spRptUTClientListMarketValue: TFloatField;
    spRptUTClientListUpfrontFee: TBooleanField;
    spRptUTClientListCustodialGroup: TIntegerField;
    spRptUTClientListCounterpartyType: TIntegerField;
    spRptUTClientListOrderField: TStringField;
    spRptUTClientListCustodialGroupName: TStringField;
    spRptUTClientListCounterpartyTypeName: TStringField;
    spRptUTClientListSelectedUnitTrustName: TStringField;
    spRptUTClientListOrderBy: TStringField;
    spRptUTClientListDateSelection: TStringField;
    spRptUTClientListValueDate: TDateTimeField;
    spRptUTClientListLastTrxDate: TDateTimeField;
    spRptUTClientListSelectedBranch: TStringField;
    spRptUTClientListCreationDate: TDateTimeField;
    spRptUTClientListUnitTrustID: TLargeintField;
    spRptUnitStatementID: TLargeintField;
    spRptUnitStatementvxType: TStringField;
    spRptUnitStatementDate: TDateTimeField;
    spRptUnitStatementValueDate: TDateTimeField;
    spRptUnitStatementAccountID: TLargeintField;
    spRptUnitStatementBalancingAccountID: TLargeintField;
    spRptUnitStatementDealID: TLargeintField;
    spRptUnitStatementTransactionType: TIntegerField;
    spRptUnitStatementPaymentType: TIntegerField;
    spRptUnitStatementAmount: TFloatField;
    spRptUnitStatementCreditAmount: TFloatField;
    spRptUnitStatementDebitAmount: TFloatField;
    spRptUnitStatementBalanceBroughForward: TFloatField;
    spRptUnitStatementBalanceBroughForwardActual: TFloatField;
    spRptUnitStatementTransactionAvailableBalance: TFloatField;
    spRptUnitStatementTransactionActualBalance: TFloatField;
    spRptUnitStatementConfirmed: TBooleanField;
    spRptUnitStatementRejected: TBooleanField;
    spRptUnitStatementAccountNo: TStringField;
    spRptUnitStatementAccountType: TIntegerField;
    spRptUnitStatementActualBalance: TFloatField;
    spRptUnitStatementAvailableBalance: TFloatField;
    spRptUnitStatementAccountTypeName: TStringField;
    spRptUnitStatementCounterpartyID: TLargeintField;
    spRptUnitStatementClientNo: TStringField;
    spRptUnitStatementAccountName: TStringField;
    spRptUnitStatementTransactionTypeName: TStringField;
    spRptUnitStatementFullTransactionTypeName: TStringField;
    spRptUnitStatementBalancingAccountNo: TStringField;
    spRptUnitStatementBalancingAccountType: TIntegerField;
    spRptUnitStatementBalancingAccountTypeName: TStringField;
    spRptUnitStatementBalancingAccountCounterpartyID: TLargeintField;
    spRptUnitStatementBalancingAccountName: TStringField;
    spRptUnitStatementBalClientNo: TStringField;
    spRptUnitStatementInstruction: TStringField;
    spRptUnitStatementDealType: TIntegerField;
    spRptUnitStatementDealEvent: TIntegerField;
    spRptUnitStatementDealTypeName: TStringField;
    spRptUnitStatementDealEventName: TStringField;
    spRptUnitStatementStatus: TIntegerField;
    spRptUnitStatementCounterName: TStringField;
    spRptUnitStatementQuantity: TFloatField;
    spRptUnitStatementCurrencyName: TStringField;
    spRptUnitStatementCurrencyDebitAmount: TFloatField;
    spRptUnitStatementCurrencyCreditAmount: TFloatField;
    spRptUnitStatementCurrencyConversionRate: TFloatField;
    spRptUnitStatementPrice: TFloatField;
    spRptUnitStatementPostalAddress: TStringField;
    spRptUnitStatementPostalAddress2: TStringField;
    spRptUnitStatementPostalAddress3: TStringField;
    spRptUnitStatementCityName: TStringField;
    spRptUnitStatementCountryName: TStringField;
    spRptUnitStatementStartDate: TDateTimeField;
    spRptUnitStatementEndDate: TDateTimeField;
    spRptUnitStatementStatementComment: TStringField;
    spRptUnitStatementUnitTrustName: TStringField;
    spRptUnitStatementStartUnitsHeld: TFloatField;
    spRptUnitStatementUnitsHeld: TFloatField;
    spRptUnitStatementBookValue: TFloatField;
    spRptUnitStatementBidPrice: TFloatField;
    spRptUnitStatementUnitsValue: TFloatField;
    spRptUnitStatementProfit: TFloatField;
    spRptUnitStatementPercentageProfit: TFloatField;
    spRptUnitStatementOrder: TIntegerField;
    QRUnitDeals: TQuickRep;
    QRBand112: TQRBand;
    QRDBText226: TQRDBText;
    QRLabel254: TQRLabel;
    QRLabel255: TQRLabel;
    QRLabel259: TQRLabel;
    QRLabel261: TQRLabel;
    QRDBText227: TQRDBText;
    QRDBText231: TQRDBText;
    QRLabel265: TQRLabel;
    QRLabel263: TQRLabel;
    QRDBImage23: TQRDBImage;
    QRDBText272: TQRDBText;
    QRLabel98: TQRLabel;
    QRExpr86: TQRExpr;
    QRExpr87: TQRExpr;
    QRBand113: TQRBand;
    QRDBText237: TQRDBText;
    QRDBText238: TQRDBText;
    QRDBText239: TQRDBText;
    QRDBText240: TQRDBText;
    QRDBText241: TQRDBText;
    QRDBText242: TQRDBText;
    QRDBText247: TQRDBText;
    QRDBText233: TQRDBText;
    QRDBText292: TQRDBText;
    QRDBText109: TQRDBText;
    QRDBText110: TQRDBText;
    QRBand115: TQRBand;
    QRSysData34: TQRSysData;
    QRLabel268: TQRLabel;
    lblUnitDealsPge: TQRLabel;
    QRSysData35: TQRSysData;
    QRBand116: TQRBand;
    QRLabel270: TQRLabel;
    QRLabel271: TQRLabel;
    QRLabel272: TQRLabel;
    QRLabel273: TQRLabel;
    QRLabel274: TQRLabel;
    QRLabel276: TQRLabel;
    QRLabel281: TQRLabel;
    QRLabel264: TQRLabel;
    QRLabel307: TQRLabel;
    QRLabel7: TQRLabel;
    QRLabel87: TQRLabel;
    QRGroup12: TQRGroup;
    QRBand117: TQRBand;
    QRExpr74: TQRExpr;
    QRExpr90: TQRExpr;
    QRExpr103: TQRExpr;
    QRExpr89: TQRExpr;
    QRLabel283: TQRLabel;
    QRGroup15: TQRGroup;
    QRBand147: TQRBand;
    QRExpr73: TQRExpr;
    QRExpr106: TQRExpr;
    QRExpr107: TQRExpr;
    QRExpr105: TQRExpr;
    QRLabel331: TQRLabel;
    QRGroup5: TQRGroup;
    QRExpr72: TQRExpr;
    QRBand47: TQRBand;
    QRExpr80: TQRExpr;
    QRExpr81: TQRExpr;
    QRExpr75: TQRExpr;
    QRLabel100: TQRLabel;
    QRExpr85: TQRExpr;
    SummaryBand3: TQRBand;
    QRExpr71: TQRExpr;
    QRExpr104: TQRExpr;
    QRShape25: TQRShape;
    QRLabel267: TQRLabel;
    QRLabel266: TQRLabel;
    QRExpr83: TQRExpr;
    procedure FormCreate(Sender: TObject);
    procedure QRUTStatementAfterPrint(Sender: TObject);
    procedure QRUnitCounterpartyHoldingsAfterPrint(Sender: TObject);
    procedure DivideValues(sender: TObject; var Value: String);
    procedure LabelPrefix(sender: TObject; var Value: String);
  private
    { Private declarations }
    DivideBy: String;
  public
    { Public declarations }
  end;

var
  frmUTQuickReports: TfrmUTQuickReports;

implementation

uses UdtmMain, UfrmMain;

{$R *.dfm}

procedure TfrmUTQuickReports.FormCreate(Sender: TObject);
begin
    tblCompany.Close;
    tblCompany.Open;
end;

procedure TfrmUTQuickReports.QRUTStatementAfterPrint(Sender: TObject);
begin
    if dtmMain.ChargeStatement then
    begin
        with spStatementPrintCharge do
        begin
            Parameters.ParamByName('@AccountID').Value := spRptUnitStatementAccountID.Value;
            Parameters.ParamByName('@ValueDate').Value := DateOf(Today);
            Prepared := True;
            ExecProc;
        end;
    end;
    dtmMain.ChargeStatement := False;
end;

procedure TfrmUTQuickReports.QRUnitCounterpartyHoldingsAfterPrint(
  Sender: TObject);
begin
    if dtmMain.ChargeStatement then
    begin
        with spStatementPrintCharge do
        begin
            Parameters.ParamByName('@AccountID').Value := spRptUnitCounterparyHoldingsAccountID.Value;
            Parameters.ParamByName('@ValueDate').Value := DateOf(Today);
            Prepared := True;
            ExecProc;
        end;
    end;
    dtmMain.ChargeStatement := False;
end;

procedure TfrmUTQuickReports.DivideValues(sender: TObject;
  var Value: String);
begin
    DivideBy := frmMain.cboDivideValues.Text;

    try
        if DivideBy = 'Thousands' then
            Value := FormatFloat(',#0.00', dtmMain.Decomma(Value) / 1000)
        else if DivideBy = 'Millions' then
            Value := FormatFloat(',#0.00', dtmMain.Decomma(Value) / 1000000)
        else if DivideBy = 'Billions' then
            Value := FormatFloat(',#0.00', dtmMain.Decomma(Value) / 1000000000)
        else if DivideBy = 'Trillions' then
            Value := FormatFloat(',#0.00', dtmMain.Decomma(Value) / 1000000000000);
    except
    end;
end;

procedure TfrmUTQuickReports.LabelPrefix(sender: TObject;
  var Value: String);
begin
    DivideBy := frmMain.cboDivideValues.Text;

    if DivideBy = 'Thousands' then
        Value := Value + ':K'
    else if DivideBy = 'Millions' then
        Value := Value + ':M'
    else if DivideBy = 'Billions' then
        Value := Value + ':B'
    else if DivideBy = 'Trillions' then
        Value := Value + ':T';
end;

end.
